import{T as C,r as Z,k as D,f as p,b as a,i as s,l as d,u as l,t as i,x as A,a as h,F as B,m as S,e as $,o as x,d as I}from"./app-BfoFl66u.js";import{D as N}from"./index-DXB66utZ.js";import v from"./AutoComplete-Clz3380k.js";import{f as u,a as T}from"./functions-CdnaNR_l.js";const P={class:"flex justify-center text-xs"},F={class:"border rounded p-2"},J={class:"border-b pb-3"},z={class:"py-1"},E={class:"py-1"},K={class:"align-top"},O={class:"py-1"},Y={class:"mt-2"},L={id:"table_pembelian_items",class:"text-slate-500 w-full"},R={class:"flex items-center mt-1"},q={class:"mt-1 hidden"},G=["onUpdate:modelValue"],Q={class:"text-center"},W={class:"flex items-center"},X=["onUpdate:modelValue","onChange"],aa=["onUpdate:modelValue"],ta={class:"ml-1"},ea={class:"text-center"},na={class:"flex items-center"},la=["onUpdate:modelValue","onChange"],ra=["onUpdate:modelValue"],oa={class:"text-center"},sa={class:"flex items-center"},da=["onUpdate:modelValue","onChange"],ma=["onUpdate:modelValue"],ua={class:"text-center"},ia={class:"flex"},_a=["onUpdate:modelValue"],ga=["onUpdate:modelValue"],ba={class:"flex justify-end items-center"},pa={class:"flex font-bold ml-2 items-center text-pink-500"},wa={__name:"AddPembelian",props:{label_suppliers:Object,label_barang:Object},setup(f){const w=f,_=new Date,t=C({date:_,day:_.getDate(),month:_.getMonth()+1,year:_.getFullYear(),supplier:{id:"",nama:""},keterangan:"",barang:[],harga_total_all:0,harga_total_all_formatted:0,nomor_nota:""});let b=Z(!1);const c=()=>{b.value=!b.value};D(t,e=>{e.day=e.date.getDate(),e.month=e.date.getMonth()+1,e.year=e.date.getFullYear()});function j(e){t.supplier.id=e.res.id,t.supplier.nama=e.res.name}const k=e=>{try{t.barang[e.index].id=e.res.id,t.barang[e.index].nama=e.res.name,t.barang[e.index].satuan_main=e.res.satuan_main,t.barang[e.index].satuan_sub=e.res.satuan_sub,t.barang[e.index].jumlah_main=e.res.jumlah_main,t.barang[e.index].jumlah_sub=e.res.jumlah_sub,t.barang[e.index].harga_main=e.res.harga_main,t.barang[e.index].harga_sub=e.res.harga_sub,t.barang[e.index].harga_total_main=e.res.harga_total_main,t.barang[e.index].jumlah_main_formatted=u(e.res.jumlah_main),t.barang[e.index].jumlah_sub_formatted=u(e.res.jumlah_sub),t.barang[e.index].harga_main_formatted=u(e.res.harga_main),t.barang[e.index].harga_total_main_formatted=u(e.res.harga_total_main),g()}catch(n){console.log(n),console.error(n)}},y=()=>{t.barang.push({})},V=e=>{t.barang[e].jumlah_main=t.barang[e].jumlah_main_formatted,t.barang[e].jumlah_main_formatted=u(t.barang[e].jumlah_main),t.barang[e].harga_total_main=t.barang[e].harga_main*t.barang[e].jumlah_sub*t.barang[e].jumlah_main,t.barang[e].harga_total_main_formatted=u(t.barang[e].harga_total_main),g()},U=e=>{t.barang[e].jumlah_sub=t.barang[e].jumlah_sub_formatted,t.barang[e].jumlah_sub_formatted=u(t.barang[e].jumlah_sub),t.barang[e].harga_total_main=t.barang[e].harga_main*t.barang[e].jumlah_sub*t.barang[e].jumlah_main,t.barang[e].harga_total_main_formatted=u(t.barang[e].harga_total_main),g()},M=e=>{t.barang[e].harga_main=t.barang[e].harga_main_formatted,t.barang[e].harga_main_formatted=u(t.barang[e].harga_main),t.barang[e].harga_total_main=t.barang[e].harga_main*t.barang[e].jumlah_sub*t.barang[e].jumlah_main,t.barang[e].harga_total_main_formatted=u(t.barang[e].harga_total_main),g()},g=()=>{t.harga_total_all=0,t.barang.forEach(e=>{let n=e.jumlah_sub*e.jumlah_main*e.harga_main;t.harga_total_all+=n}),t.harga_total_all_formatted=T(t.harga_total_all)},H=()=>{confirm("Apakah data yang diinput sudah benar?")&&t.post(route("pembelians.store"))};return(e,n)=>(x(),p("div",P,[a("form",{onSubmit:$(H,["prevent"]),class:"border rounded border-emerald-300 p-1 mt-1 lg:w-3/5 md:w-3/4"},[a("div",F,[a("div",J,[a("table",null,[a("tbody",null,[a("tr",null,[n[5]||(n[5]=a("td",null,"Nomor",-1)),n[6]||(n[6]=a("td",null,[a("div",{class:"mx-2"},":")],-1)),a("td",null,[s(a("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=m=>l(t).nomor_nota=m),class:"rounded p-1 text-xs",placeholder:"nomor nota ..."},null,512),[[d,l(t).nomor_nota]])])]),a("tr",null,[n[8]||(n[8]=a("td",null,"Tanggal",-1)),n[9]||(n[9]=a("td",null,[a("div",{class:"mx-2"},":")],-1)),a("td",z,[a("div",{onClick:c,class:"border p-2 flex justify-between items-center"},[a("span",null,i(l(t).day)+"-"+i(l(t).month)+"-"+i(l(t).year),1),n[7]||(n[7]=a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",class:"size-6"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"})],-1))]),s(a("div",null,[h(l(N),{modelValue:l(t).date,"onUpdate:modelValue":n[1]||(n[1]=m=>l(t).date=m),mode:"date"},null,8,["modelValue"])],512),[[A,l(b)]])])]),a("tr",null,[n[10]||(n[10]=a("td",null,"Supplier",-1)),n[11]||(n[11]=a("td",null,[a("div",{class:"mx-2"},":")],-1)),a("td",E,[h(v,{source:w.label_suppliers,index:null,onItem:j},null,8,["source"])])]),a("tr",K,[n[12]||(n[12]=a("td",null,"Ket. (opt.)",-1)),n[13]||(n[13]=a("td",null,[a("div",{class:"mx-2"},":")],-1)),a("td",O,[s(a("textarea",{"onUpdate:modelValue":n[2]||(n[2]=m=>l(t).keterangan=m),cols:"30",rows:"5",class:"border rounded p-1 text-xs",placeholder:"keterangan (opt.)"},null,512),[[d,l(t).keterangan]])])])])])]),a("div",Y,[a("table",L,[n[18]||(n[18]=a("thead",null,[a("tr",null,[a("th",null,"Nama Item"),a("th",null,"Jml. Sub"),a("th",null,"Jml. Main"),a("th",null,"Hrg."),a("th",null,"Hrg. t"),a("th")])],-1)),a("tbody",null,[a("tr",{id:"tr_add_item"},[a("td",null,[a("button",{type:"button",class:"rounded bg-emerald-200 text-emerald-600",onClick:y},n[14]||(n[14]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1)]))])]),(x(!0),p(B,null,S(l(t).barang,(m,r)=>(x(),p("tr",null,[a("td",null,[a("div",R,[n[15]||(n[15]=a("button",{id:"toggle_barang_keterangan-${index_item}",type:"button",class:"border border-yellow-500 rounded text-yellow-500",onclick:"toggle_light(this.id,'barang_keterangan-${index_item}', [], ['bg-yellow-300'], 'block')"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"3",stroke:"currentColor",class:"w-3 h-3"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])],-1)),h(v,{source:f.label_barang,index:r,onItem:k},null,8,["source","index"])]),a("div",q,[s(a("textarea",{"onUpdate:modelValue":o=>l(t).barang[r].keterangan=o,cols:"30",rows:"3",class:"border-slate-300 rounded-lg text-xs p-0 placeholder:text-slate-400",placeholder:"keterangan item..."},null,8,G),[[d,l(t).barang[r].keterangan]])])]),a("td",null,[a("div",Q,[a("div",W,[s(a("input",{type:"text","onUpdate:modelValue":o=>l(t).barang[r].jumlah_sub_formatted=o,onChange:o=>U(r),class:"border-slate-300 rounded-lg text-xs p-1 w-1/2"},null,40,X),[[d,l(t).barang[r].jumlah_sub_formatted]]),s(a("input",{type:"hidden","onUpdate:modelValue":o=>l(t).barang[r].jumlah_sub=o},null,8,aa),[[d,l(t).barang[r].jumlah_sub]]),a("span",ta,i(l(t).barang[r].satuan_sub),1)])])]),a("td",null,[a("div",ea,[a("div",na,[s(a("input",{type:"text","onUpdate:modelValue":o=>l(t).barang[r].jumlah_main_formatted=o,onChange:o=>V(r),min:"1",step:"1",class:"border-slate-300 rounded-lg text-xs p-1 w-1/2"},null,40,la),[[d,l(t).barang[r].jumlah_main_formatted]]),s(a("input",{type:"hidden","onUpdate:modelValue":o=>l(t).barang[r].jumlah_main=o},null,8,ra),[[d,l(t).barang[r].jumlah_main]]),a("span",null,i(l(t).barang[r].satuan_main),1)])])]),a("td",null,[a("div",oa,[a("div",sa,[s(a("input",{type:"text","onUpdate:modelValue":o=>l(t).barang[r].harga_main_formatted=o,onChange:o=>M(r),class:"border-slate-300 rounded-lg text-xs p-1 w-3/4"},null,40,da),[[d,l(t).barang[r].harga_main_formatted]]),n[16]||(n[16]=I("/")),a("span",null,i(l(t).barang[r].satuan_main),1),s(a("input",{type:"hidden","onUpdate:modelValue":o=>l(t).barang[r].harga_main=o},null,8,ma),[[d,l(t).barang[r].harga_main]])])])]),a("td",null,[a("div",ua,[a("div",ia,[s(a("input",{type:"text","onUpdate:modelValue":o=>l(t).barang[r].harga_total_main_formatted=o,class:"border-slate-300 rounded-lg text-xs p-1 w-full"},null,8,_a),[[d,l(t).barang[r].harga_total_main_formatted]]),s(a("input",{type:"hidden","onUpdate:modelValue":o=>l(t).barang[r].harga_total_main=o},null,8,ga),[[d,l(t).barang[r].harga_total_main]])])])]),n[17]||(n[17]=a("td",null,[a("button",{type:"button",class:"text-red-500",onclick:"remove_item(${index_item})"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",class:"w-5 h-5"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})])])],-1))]))),256))])]),a("div",ba,[n[20]||(n[20]=a("span",{class:"font-bold"},"Total",-1)),a("div",pa,[n[19]||(n[19]=a("span",null,"Rp",-1)),s(a("input",{type:"text","onUpdate:modelValue":n[3]||(n[3]=m=>l(t).harga_total_all_formatted=m),class:"border-none p-1 w-28 ml-2"},null,512),[[d,l(t).harga_total_all_formatted]]),s(a("input",{type:"hidden","onUpdate:modelValue":n[4]||(n[4]=m=>l(t).harga_total_all=m)},null,512),[[d,l(t).harga_total_all]])])])])]),n[21]||(n[21]=a("div",{class:"flex justify-center mt-3"},[a("button",{type:"submit",class:"border-2 border-emerald-300 bg-emerald-200 text-emerald-600 rounded-lg font-semibold py-1 px-3 hover:bg-emerald-300"},"Proses/Konfirmasi")],-1))],32)]))}};export{wa as default};
